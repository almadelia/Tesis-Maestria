{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(junta,lower=año[i], upper=año[i+1], vectores=c(vector,i,q))$value
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
vector=c(1,3,4,2)
q=8
objetivo(vector,q)
inicial=c(vector,q)
nlminb(inicial,objetivo)
#generar un vector incial:
#generar numeros aleatorios
f2 <- function (t, z) {
exp(-t*z)
}
int2 <- function (z) {
integrate(f2,  lower=0, upper=Inf, z=z)$value
}
int2(1)
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-(a/b)-B_0^(1-n)*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
vector=c(-0.5,0.3,0.2,-0.1,-0.1)
objetivo(vector)
nlminb(inicial,objetivo)
#generar un vector incial
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-(a/b)-B_0^(1-n)*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
vector=c(-0.5,0.3,0.2,-5,-0.1)
objetivo(vector)
nlminb(inicial,objetivo)
#generar un vector incial:
vector=c(-0.5,0.3,0.2,-5,-0.1)
objetivo(vector)
vector=c(-0.5,0.1,0.2,-5,-0.1)
objetivo(vector)
vector=c(-0.5,0.1,0.2,-5,-0.1)
objetivo(vector)
vector=c(-0.5,5,0.2,-5,-0.1)
objetivo(vector)
vector=c(3,5,0.2,-5,-0.1)
objetivo(vector)
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-((a/b)-B_0^(1-n))*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
vector=c(3,5,0.2,-5,-0.1)
objetivo(vector)
nlminb(inicial,objetivo)
#generar un vector incial:
vector=c(3,5,2,-5,-0.1)
objetivo(vector)
i=1
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
teta=c(3,5,2,-5,-0.1)
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]+c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,-5,-0.1)
objetivo(vector)
nlminb(inicial,objetivo)
nlminb(teta,objetivo)
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-((a/b)-B_0^(1-n))*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,5,-0.1)
objetivo(vector)
nlminb(teta,objetivo)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]+c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,5,-0.1)
objetivo(vector)
nlminb(teta,objetivo)
#generar un vector incial:
i=1
nlminb(teta,objetivo)
objetivo(vector)
teta=c(3,5,2,5,-0.1)
objetivo(vector)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]+c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,5,-0.1)
objetivo(vector)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]+c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,5,-0.1)
objetivo(vector)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
teta=c(3,5,2,5,-0.1)
objetivo(vector)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
teta=c(-3,-0.4,2,5,0.1)
objetivo(vector)
objetivo(teta)
nlminb(teta,objetivo)
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
FF=q*Esfuerzo[i]
aux=(a/(b+FF))-((a/(b+FF))-B_0^(1-n))*exp(-(b+Esfuerzo[i])*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
teta=c(-3,-0.4,2,5,0.1)
objetivo(teta)
nlminb(teta,objetivo)
rm(list=ls(all=TRUE))
rm(list=ls(all=TRUE))
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-((a/b)-B_0^(1-n))*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
#teta=c(a,b,B_0,n,q)
#teta=c(-3,-0.4,2,5,0.1) con estos converge a algo
teta=c()
objetivo(teta)
nlminb(teta,objetivo)
rm(list=ls(all=TRUE))
año<-seq(1959, 1984, 1);año
Captura<-c(62459, 79677, 72724, 34948, 69742, 64461, 99187, 108919, 22674, 165512, 117705, 111561, 126296, 103374, 80429, 73389, 44174, 24283, 17604, 14718, 27940, 19990, 24344, 31605,28818, 25452);Captura
Esfuerzo<-c(64912, 93291, 77831, 28600, 42409, 53072, 82366, 82064, 13255, 190270, 128611, 128392, 175591, 104717, 157852, 90768, 49151, 28263, 19829, 15715, 22649, 20358, 20016, 21589, 18158, 18517);Esfuerzo
CPUE<-Captura/Esfuerzo;CPUE
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
aux=(a/(b))-((a/b)-B_0^(1-n))*exp(-b*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
teta=c(-3,-0.4,2,5,0.1)
objetivo(teta)
nlminb(teta,objetivo)
rm(list=ls(all=TRUE))
#crecimiento de la biomasa con pesca
año<-seq(1959, 1984, 1);año
Captura<-c(62459, 79677, 72724, 34948, 69742, 64461, 99187, 108919, 22674, 165512, 117705, 111561, 126296, 103374, 80429, 73389, 44174, 24283, 17604, 14718, 27940, 19990, 24344, 31605,28818, 25452);Captura
Esfuerzo<-c(64912, 93291, 77831, 28600, 42409, 53072, 82366, 82064, 13255, 190270, 128611, 128392, 175591, 104717, 157852, 90768, 49151, 28263, 19829, 15715, 22649, 20358, 20016, 21589, 18158, 18517);Esfuerzo
CPUE<-Captura/Esfuerzo;CPUE
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
FF=q*Esfuerzo[i]
aux=(a/(b+FF))-((a/(b+FF))-B_0^(1-n))*exp(-(b+Esfuerzo[i])*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
#teta=c(a,b,B_0,n,q)
#teta=c(-3,-0.4,2,5,0.1) con estos converge a algo
teta=c(-3,-0.4,2,5,0.1)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-2,-.5,4,2,0.2)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(4,4,4,2,0.2)
objetivo(teta)
nlminb(teta,objetivo)
rm(list=ls(all=TRUE))
#crecimiento de la biomasa con pesca
año<-seq(1959, 1984, 1);año
Captura<-c(62459, 79677, 72724, 34948, 69742, 64461, 99187, 108919, 22674, 165512, 117705, 111561, 126296, 103374, 80429, 73389, 44174, 24283, 17604, 14718, 27940, 19990, 24344, 31605,28818, 25452);Captura
Esfuerzo<-c(64912, 93291, 77831, 28600, 42409, 53072, 82366, 82064, 13255, 190270, 128611, 128392, 175591, 104717, 157852, 90768, 49151, 28263, 19829, 15715, 22649, 20358, 20016, 21589, 18158, 18517);Esfuerzo
CPUE<-Captura/Esfuerzo;CPUE
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
FF=q*Esfuerzo[i]
aux=(a/(b+FF))-((a/(b+FF))-B_0^(1-n))*exp(-(b+Esfuerzo[i])*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
#teta=c(a,b,B_0,n,q)
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
#teta=c(a,b,B_0,n,q)
#teta=c(-3,-0.4,2,5,0.1) con estos converge a algo
teta=c(4,4,4,2,0.2)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(4,4,4,2,4)
objetivo(teta)
teta=c(4,15,26,5,2)
objetivo(teta)
teta=c(0.3,0.2,0.1,0.4,0.1)
objetivo(teta)
nlminb(teta,objetivo)
Bt<-function(t,vector)
{
a=vector[1]
b=vector[2]
B_0=vector[3]
n=vector[4]
q=vector[5]
i=vector[6]
FF=q*Esfuerzo[i]
aux=(a/(b+FF))-((a/(b+FF))-B_0^(1-n))*exp(-(b+Esfuerzo[i])*(1-n)*t)
r=aux^(1/(1-n))
regresa=r*q*Esfuerzo[i]
return(regresa)
}
objetivo<-function(teta)
{
suma=0
c_i=0
for (i in 1:(length(año)-1))
{
c_i=integrate(Bt,lower=año[i], upper=año[i+1], vector=c(teta,i))$value
c_i
suma=(Captura[i]-c_i)^2 +suma
}
return(suma)
}
#teta=c(a,b,B_0,n,q)
#teta=c(-3,-0.4,2,5,0.1) con estos converge a algo
teta=c(0.3,0.2,0.1,0.4,0.1)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(0.3,0.2,0.1,4,0.1)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(0.2,0.1,0.1,4,3)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(0.2,0.1,0.1,0.5,3)
objetivo(teta)
nlminb(teta,objetivo)
?nlmind
?nlminb
teta=c(-2,0.1,0.1,0.5,3)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(2,0.1,0.1,0.5,3)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(2,0.1,0.1,0.5,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(2,0.1,0.1,0.1,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(2,0.1,0.1,0.1,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(2,10,0.1,-11,30)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-3,-4,2,9,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-3,-4,2,9,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-3,-4,2,9,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-3,-8,2,9,4)
objetivo(teta)
nlminb(teta,objetivo)
teta=c(-3,-8,6,9,4)
nlminb(teta,objetivo)
